--[[

Intel instructions, borrowed from distorm disassembler

This is a plaything.

Need to be able to generate instructions from core principles.

--]]
package.path = "../?.lua;"..package.path

local enum = require("peettles.enum")

local InstructionType =  enum {
     UNDEFINED = 0, 
     AAA = 66, 
     AAD = 389, 
     AAM = 384, 
     AAS = 76, 
     ADC = 31, 
     ADD = 11, 
     ADDPD = 3132,
     ADDPS = 3125, 
     ADDSD = 3146, 
     ADDSS = 3139, 
     ADDSUBPD = 6416, 
     ADDSUBPS = 6426,
     AESDEC = 9231, 
     AESDECLAST = 9248, 
     AESENC = 9189, 
     AESENCLAST = 9206,
     AESIMC = 9172, 
     AESKEYGENASSIST = 9817, 
     AND = 41, 
     ANDNPD = 3043, 
     ANDNPS = 3035,
     ANDPD = 3012, 
     ANDPS = 3005, 
     ARPL = 111, 
     BLENDPD = 9394, 
     BLENDPS = 9375,
     BLENDVPD = 7641, 
     BLENDVPS = 7631, 
     BOUND = 104, 
     BSF = 4368, 
     BSR = 4380,
     BSWAP = 960, 
     BT = 872, 
     BTC = 934, 
     BTR = 912, 
     BTS = 887, 
     CALL = 456,
	 CALL_FAR = 260, CBW = 228, CDQ = 250, CDQE = 239, CLC = 492, CLD = 512,
	 CLFLUSH = 4351, CLGI = 1855, CLI = 502, CLTS = 541, CMC = 487, CMOVA = 694,
	 CMOVAE = 663, CMOVB = 656, CMOVBE = 686, CMOVG = 754, CMOVGE = 738,
	 CMOVL = 731, CMOVLE = 746, CMOVNO = 648, CMOVNP = 723, CMOVNS = 708,
	 CMOVNZ = 678, CMOVO = 641, CMOVP = 716, CMOVS = 701, CMOVZ = 671,
	 CMP = 71, CMPEQPD = 4471, CMPEQPS = 4392, CMPEQSD = 4629, CMPEQSS = 4550,
	 CMPLEPD = 4489, CMPLEPS = 4410, CMPLESD = 4647, CMPLESS = 4568, CMPLTPD = 4480,
	 CMPLTPS = 4401, CMPLTSD = 4638, CMPLTSS = 4559, CMPNEQPD = 4510, CMPNEQPS = 4431,
	 CMPNEQSD = 4668, CMPNEQSS = 4589, CMPNLEPD = 4530, CMPNLEPS = 4451,
	 CMPNLESD = 4688, CMPNLESS = 4609, CMPNLTPD = 4520, CMPNLTPS = 4441,
	 CMPNLTSD = 4678, CMPNLTSS = 4599, CMPORDPD = 4540, CMPORDPS = 4461,
	 CMPORDSD = 4698, CMPORDSS = 4619, CMPS = 301, CMPUNORDPD = 4498, CMPUNORDPS = 4419,
	 CMPUNORDSD = 4656, CMPUNORDSS = 4577, CMPXCHG = 898, CMPXCHG16B = 6395,
	 CMPXCHG8B = 6384, COMISD = 2801, COMISS = 2793, CPUID = 865, CQO = 255,
	 CRC32 = 9280, CVTDQ2PD = 6809, CVTDQ2PS = 3329, CVTPD2DQ = 6819, CVTPD2PI = 2703,
	 CVTPD2PS = 3255, CVTPH2PS = 4183, CVTPI2PD = 2517, CVTPI2PS = 2507,
	 CVTPS2DQ = 3339, CVTPS2PD = 3245, CVTPS2PH = 4193, CVTPS2PI = 2693,
	 CVTSD2SI = 2723, CVTSD2SS = 3275, CVTSI2SD = 2537, CVTSI2SS = 2527,
	 CVTSS2SD = 3265, CVTSS2SI = 2713, CVTTPD2DQ = 6798, CVTTPD2PI = 2636,
	 CVTTPS2DQ = 3349, CVTTPS2PI = 2625, CVTTSD2SI = 2658, CVTTSS2SI = 2647,
	 CWD = 245, CWDE = 233, DAA = 46, DAS = 56, DEC = 86, DIV = 1646,
	 DIVPD = 3521, DIVPS = 3514, DIVSD = 3535, DIVSS = 3528, DPPD = 9637,
	 DPPS = 9624, EMMS = 4122, ENTER = 340, EXTRACTPS = 9502, EXTRQ = 4158,
     F2XM1 = 1192, 
     FABS = 1123, 
     FADD = 1023, 
     FADDP = 1549, 
     FBLD = 1601,
     FBSTP = 1607, 
     FCHS = 1117, 
     FCLEX = 7311, 
     FCMOVB = 1376, 
     FCMOVBE = 1392,
     FCMOVE = 1384, 
     FCMOVNB = 1445, 
     FCMOVNBE = 1463, 
     FCMOVNE = 1454, 
     FCMOVNU = 1473,
     FCMOVU = 1401, 
     FCOM = 1035, 
     FCOMI = 1512, 
     FCOMIP = 1623, 
     FCOMP = 1041,
     FCOMPP = 1563, 
     FCOS = 1311, 
     FDECSTP = 1238, 
     FDIV = 1061, 
     FDIVP = 1594,
     FDIVR = 1067, 
     FDIVRP = 1586, 
     FEDISI = 1488, 
     FEMMS = 574, 
     FENI = 1482,
     FFREE = 1527, 
     FIADD = 1317, 
     FICOM = 1331, 
     FICOMP = 1338, 
     FIDIV = 1361,
     FIDIVR = 1368, 
     FILD = 1418, 
     FIMUL = 1324, 
     FINCSTP = 1247, 
     FINIT = 7326,
     FIST = 1432, 
     FISTP = 1438, 
     FISTTP = 1424, 
     FISUB = 1346, 
     FISUBR = 1353,
     FLD = 1074, 
     FLD1 = 1141, 
     FLDCW = 1098, 
     FLDENV = 1090, 
     FLDL2E = 1155,
	 FLDL2T = 1147, FLDLG2 = 1170, FLDLN2 = 1178, FLDPI = 1163, FLDZ = 1186,
	 FMUL = 1029, FMULP = 1556, FNCLEX = 7303, FNINIT = 7318, FNOP = 1111,
	 FNSAVE = 7333, FNSTCW = 7288, FNSTENV = 7271, FNSTSW = 7348, FPATAN = 1213,
	 FPREM = 1256, FPREM1 = 1230, FPTAN = 1206, FRNDINT = 1288, FRSTOR = 1519,
	 FSAVE = 7341, FSCALE = 1297, FSETPM = 1496, FSIN = 1305, FSINCOS = 1279,
	 FSQRT = 1272, FST = 1079, FSTCW = 7296, FSTENV = 7280, FSTP = 1084,
	 FSTSW = 7356, FSUB = 1048, FSUBP = 1579, FSUBR = 1054, FSUBRP = 1571,
	 FTST = 1129, FUCOM = 1534, FUCOMI = 1504, FUCOMIP = 1614, FUCOMP = 1541,
	 FUCOMPP = 1409, FXAM = 1135, FXCH = 1105, FXRSTOR = 9914, FXRSTOR64 = 9923,
	 FXSAVE = 9886, FXSAVE64 = 9894, FXTRACT = 1221, FYL2X = 1199, FYL2XP1 = 1263,
     GETSEC = 633, 
     HADDPD = 4203, 
     HADDPS = 4211, 
     HLT = 482, 
     HSUBPD = 4237,
     HSUBPS = 4245, 
     IDIV = 1651, 
     IMUL = 117, 
     IN = 447, 
     INC = 81, 
     INS = 123,
     INSERTPS = 9569, 
     INSERTQ = 4165, 
     INT = 367, 
     INT_3 = 360, 
     INT1 = 476,
     INTO = 372, 
     INVD = 555, 
     INVEPT = 8306, 
     INVLPG = 1727, 
     INVLPGA = 1869,
     INVPCID = 8323, 
     INVVPID = 8314, 
     IRET = 378, 
     JA = 166, 
     JAE = 147,
	 JB = 143, JBE = 161, JCXZ = 427, JECXZ = 433, JG = 202, JGE = 192,
	 JL = 188, JLE = 197, JMP = 462, JMP_FAR = 467, JNO = 138, JNP = 183,
	 JNS = 174, JNZ = 156, JO = 134, JP = 179, JRCXZ = 440, JS = 170,
	 JZ = 152, LAHF = 289, LAR = 522, LDDQU = 7016, LDMXCSR = 9944, LDS = 335,
	 LEA = 223, LEAVE = 347, LES = 330, LFENCE = 4287, LFS = 917, LGDT = 1703,
	 LGS = 922, LIDT = 1709, LLDT = 1668, LMSW = 1721, LODS = 313, LOOP = 421,
	 LOOPNZ = 406, LOOPZ = 414, LSL = 527, LSS = 907, LTR = 1674, LZCNT = 4385,
	 MASKMOVDQU = 7141, MASKMOVQ = 7131, MAXPD = 3581, MAXPS = 3574, MAXSD = 3595,
	 MAXSS = 3588, MFENCE = 4313, MINPD = 3461, MINPS = 3454, MINSD = 3475,
	 MINSS = 3468, MONITOR = 1771, MOV = 218, MOVAPD = 2481, MOVAPS = 2473,
	 MOVBE = 9273, MOVD = 3942, MOVDDUP = 2208, MOVDQ2Q = 6544, MOVDQA = 3968,
	 MOVDQU = 3976, MOVHLPS = 2173, MOVHPD = 2367, MOVHPS = 2359, MOVLHPS = 2350,
	 MOVLPD = 2190, MOVLPS = 2182, MOVMSKPD = 2837, MOVMSKPS = 2827, MOVNTDQ = 6871,
	 MOVNTDQA = 7917, MOVNTI = 952, MOVNTPD = 2578, MOVNTPS = 2569, MOVNTQ = 6863,
	 MOVNTSD = 2596, MOVNTSS = 2587, MOVQ = 3948, MOVQ2DQ = 6535, MOVS = 295,
	 MOVSD = 2132, MOVSHDUP = 2375, MOVSLDUP = 2198, MOVSS = 2125, MOVSX = 939,
	 MOVSXD = 10027, MOVUPD = 2117, MOVUPS = 2109, MOVZX = 927, MPSADBW = 9650,
	 MUL = 1641, MULPD = 3192, MULPS = 3185, MULSD = 3206, MULSS = 3199,
	 MWAIT = 1780, NEG = 1636, NOP = 581, NOT = 1631, OR = 27, ORPD = 3075,
	 ORPS = 3069, OUT = 451, OUTS = 128, PABSB = 7710, PABSD = 7740, PABSW = 7725,
	 PACKSSDW = 3871, PACKSSWB = 3703, PACKUSDW = 7938, PACKUSWB = 3781,
	 PADDB = 7226, PADDD = 7256, PADDQ = 6503, PADDSB = 6952, PADDSW = 6969,
	 PADDUSB = 6642, PADDUSW = 6661, PADDW = 7241, PALIGNR = 9432, PAND = 6629,
	 PANDN = 6687, PAUSE = 10035, PAVGB = 6702, PAVGUSB = 2100, PAVGW = 6747,
	 PBLENDVB = 7621, PBLENDW = 9413, PCLMULQDQ = 9669, PCMPEQB = 4065,
	 PCMPEQD = 4103, PCMPEQQ = 7898, PCMPEQW = 4084, PCMPESTRI = 9748,
	 PCMPESTRM = 9725, PCMPGTB = 3724, PCMPGTD = 3762, PCMPGTQ = 8109,
	 PCMPGTW = 3743, PCMPISTRI = 9794, PCMPISTRM = 9771, PEXTRB = 9451,
	 PEXTRD = 9468, PEXTRQ = 9476, PEXTRW = 6333, PF2ID = 1936, PF2IW = 1929,
	 PFACC = 2050, PFADD = 1999, PFCMPEQ = 2057, PFCMPGE = 1960, PFCMPGT = 2006,
	 PFMAX = 2015, PFMIN = 1969, PFMUL = 2066, PFNACC = 1943, PFPNACC = 1951,
	 PFRCP = 1976, PFRCPIT1 = 2022, PFRCPIT2 = 2073, PFRSQIT1 = 2032, PFRSQRT = 1983,
	 PFSUB = 1992, PFSUBR = 2042, PHADDD = 7397, PHADDSW = 7414, PHADDW = 7380,
	 PHMINPOSUW = 8281, PHSUBD = 7473, PHSUBSW = 7490, PHSUBW = 7456, PI2FD = 1922,
	 PI2FW = 1915, PINSRB = 9552, PINSRD = 9590, PINSRQ = 9598, PINSRW = 6316,
	 PMADDUBSW = 7433, PMADDWD = 7095, PMAXSB = 8196, PMAXSD = 8213, PMAXSW = 6986,
	 PMAXUB = 6670, PMAXUD = 8247, PMAXUW = 8230, PMINSB = 8128, PMINSD = 8145,
	 PMINSW = 6924, PMINUB = 6612, PMINUD = 8179, PMINUW = 8162, PMOVMSKB = 6553,
	 PMOVSXBD = 7776, PMOVSXBQ = 7797, PMOVSXBW = 7755, PMOVSXDQ = 7860,
	 PMOVSXWD = 7818, PMOVSXWQ = 7839, PMOVZXBD = 8004, PMOVZXBQ = 8025,
	 PMOVZXBW = 7983, PMOVZXDQ = 8088, PMOVZXWD = 8046, PMOVZXWQ = 8067,
	 PMULDQ = 7881, PMULHRSW = 7560, PMULHRW = 2083, PMULHUW = 6762, PMULHW = 6781,
	 PMULLD = 8264, PMULLW = 6518, PMULUDQ = 7076, POP = 22, POPA = 98,
	 POPCNT = 4360, POPF = 277, POR = 6941, PREFETCH = 1894, PREFETCHNTA = 2424,
	 PREFETCHT0 = 2437, PREFETCHT1 = 2449, PREFETCHT2 = 2461, PREFETCHW = 1904,
	 PSADBW = 7114, PSHUFB = 7363, PSHUFD = 4010, PSHUFHW = 4018, PSHUFLW = 4027,
	 PSHUFW = 4002, PSIGNB = 7509, PSIGND = 7543, PSIGNW = 7526, PSLLD = 7046,
	 PSLLDQ = 9869, PSLLQ = 7061, PSLLW = 7031, PSRAD = 6732, PSRAW = 6717,
	 PSRLD = 6473, PSRLDQ = 9852, PSRLQ = 6488, PSRLW = 6458, PSUBB = 7166,
	 PSUBD = 7196, PSUBQ = 7211, PSUBSB = 6890, PSUBSW = 6907, PSUBUSB = 6574,
	 PSUBUSW = 6593, PSUBW = 7181, PSWAPD = 2092, PTEST = 7651, PUNPCKHBW = 3802,
	 PUNPCKHDQ = 3848, PUNPCKHQDQ = 3917, PUNPCKHWD = 3825, PUNPCKLBW = 3634,
	 PUNPCKLDQ = 3680, PUNPCKLQDQ = 3892, PUNPCKLWD = 3657, PUSH = 16,
	 PUSHA = 91, PUSHF = 270, PXOR = 7003, RCL = 977, RCPPS = 2975, RCPSS = 2982,
	 RCR = 982, RDFSBASE = 9904, RDGSBASE = 9934, RDMSR = 600, RDPMC = 607,
	 RDRAND = 10048, RDTSC = 593, RDTSCP = 1886, RET = 325, RETF = 354,
	 ROL = 967, ROR = 972, ROUNDPD = 9318, ROUNDPS = 9299, ROUNDSD = 9356,
	 ROUNDSS = 9337, RSM = 882, RSQRTPS = 2937, RSQRTSS = 2946, SAHF = 283,
	 SAL = 997, SALC = 394, SAR = 1002, SBB = 36, SCAS = 319, SETA = 807,
	 SETAE = 780, SETB = 774, SETBE = 800, SETG = 859, SETGE = 845, SETL = 839,
	 SETLE = 852, SETNO = 767, SETNP = 832, SETNS = 819, SETNZ = 793,
	 SETO = 761, SETP = 826, SETS = 813, SETZ = 787, SFENCE = 4343, SGDT = 1691,
	 SHL = 987, SHLD = 876, SHR = 992, SHRD = 892, SHUFPD = 6358, SHUFPS = 6350,
	 SIDT = 1697, SKINIT = 1861, SLDT = 1657, SMSW = 1715, SQRTPD = 2877,
	 SQRTPS = 2869, SQRTSD = 2893, SQRTSS = 2885, STC = 497, STD = 517,
	 STGI = 1849, STI = 507, STMXCSR = 9973, STOS = 307, STR = 1663, SUB = 51,
	 SUBPD = 3401, SUBPS = 3394, SUBSD = 3415, SUBSS = 3408, SWAPGS = 1878,
	 SYSCALL = 532, SYSENTER = 614, SYSEXIT = 624, SYSRET = 547, TEST = 206,
	 TZCNT = 4373, UCOMISD = 2764, UCOMISS = 2755, UD2 = 569, UNPCKHPD = 2318,
	 UNPCKHPS = 2308, UNPCKLPD = 2276, UNPCKLPS = 2266, VADDPD = 3161,
	 VADDPS = 3153, VADDSD = 3177, VADDSS = 3169, VADDSUBPD = 6436, VADDSUBPS = 6447,
	 VAESDEC = 9239, VAESDECLAST = 9260, VAESENC = 9197, VAESENCLAST = 9218,
	 VAESIMC = 9180, VAESKEYGENASSIST = 9834, VANDNPD = 3060, VANDNPS = 3051,
	 VANDPD = 3027, VANDPS = 3019, VBLENDPD = 9403, VBLENDPS = 9384, VBLENDVPD = 9703,
	 VBLENDVPS = 9692, VBROADCASTF128 = 7694, VBROADCASTSD = 7680, VBROADCASTSS = 7666,
	 VCMPEQPD = 5110, VCMPEQPS = 4708, VCMPEQSD = 5914, VCMPEQSS = 5512,
	 VCMPEQ_OSPD = 5291, VCMPEQ_OSPS = 4889, VCMPEQ_OSSD = 6095, VCMPEQ_OSSS = 5693,
	 VCMPEQ_UQPD = 5197, VCMPEQ_UQPS = 4795, VCMPEQ_UQSD = 6001, VCMPEQ_UQSS = 5599,
	 VCMPEQ_USPD = 5400, VCMPEQ_USPS = 4998, VCMPEQ_USSD = 6204, VCMPEQ_USSS = 5802,
	 VCMPFALSEPD = 5232, VCMPFALSEPS = 4830, VCMPFALSESD = 6036, VCMPFALSESS = 5634,
	 VCMPFALSE_OSPD = 5441, VCMPFALSE_OSPS = 5039, VCMPFALSE_OSSD = 6245,
	 VCMPFALSE_OSSS = 5843, VCMPGEPD = 5259, VCMPGEPS = 4857, VCMPGESD = 6063,
	 VCMPGESS = 5661, VCMPGE_OQPD = 5471, VCMPGE_OQPS = 5069, VCMPGE_OQSD = 6275,
	 VCMPGE_OQSS = 5873, VCMPGTPD = 5269, VCMPGTPS = 4867, VCMPGTSD = 6073,
	 VCMPGTSS = 5671, VCMPGT_OQPD = 5484, VCMPGT_OQPS = 5082, VCMPGT_OQSD = 6288,
	 VCMPGT_OQSS = 5886, VCMPLEPD = 5130, VCMPLEPS = 4728, VCMPLESD = 5934,
	 VCMPLESS = 5532, VCMPLE_OQPD = 5317, VCMPLE_OQPS = 4915, VCMPLE_OQSD = 6121,
	 VCMPLE_OQSS = 5719, VCMPLTPD = 5120, VCMPLTPS = 4718, VCMPLTSD = 5924,
	 VCMPLTSS = 5522, VCMPLT_OQPD = 5304, VCMPLT_OQPS = 4902, VCMPLT_OQSD = 6108,
	 VCMPLT_OQSS = 5706, VCMPNEQPD = 5153, VCMPNEQPS = 4751, VCMPNEQSD = 5957,
	 VCMPNEQSS = 5555, VCMPNEQ_OQPD = 5245, VCMPNEQ_OQPS = 4843, VCMPNEQ_OQSD = 6049,
	 VCMPNEQ_OQSS = 5647, VCMPNEQ_OSPD = 5457, VCMPNEQ_OSPS = 5055, VCMPNEQ_OSSD = 6261,
	 VCMPNEQ_OSSS = 5859, VCMPNEQ_USPD = 5345, VCMPNEQ_USPS = 4943, VCMPNEQ_USSD = 6149,
	 VCMPNEQ_USSS = 5747, VCMPNGEPD = 5210, VCMPNGEPS = 4808, VCMPNGESD = 6014,
	 VCMPNGESS = 5612, VCMPNGE_UQPD = 5413, VCMPNGE_UQPS = 5011, VCMPNGE_UQSD = 6217,
	 VCMPNGE_UQSS = 5815, VCMPNGTPD = 5221, VCMPNGTPS = 4819, VCMPNGTSD = 6025,
	 VCMPNGTSS = 5623, VCMPNGT_UQPD = 5427, VCMPNGT_UQPS = 5025, VCMPNGT_UQSD = 6231,
	 VCMPNGT_UQSS = 5829, VCMPNLEPD = 5175, VCMPNLEPS = 4773, VCMPNLESD = 5979,
	 VCMPNLESS = 5577, VCMPNLE_UQPD = 5373, VCMPNLE_UQPS = 4971, VCMPNLE_UQSD = 6177,
	 VCMPNLE_UQSS = 5775, VCMPNLTPD = 5164, VCMPNLTPS = 4762, VCMPNLTSD = 5968,
	 VCMPNLTSS = 5566, VCMPNLT_UQPD = 5359, VCMPNLT_UQPS = 4957, VCMPNLT_UQSD = 6163,
	 VCMPNLT_UQSS = 5761, VCMPORDPD = 5186, VCMPORDPS = 4784, VCMPORDSD = 5990,
	 VCMPORDSS = 5588, VCMPORD_SPD = 5387, VCMPORD_SPS = 4985, VCMPORD_SSD = 6191,
	 VCMPORD_SSS = 5789, VCMPTRUEPD = 5279, VCMPTRUEPS = 4877, VCMPTRUESD = 6083,
	 VCMPTRUESS = 5681, VCMPTRUE_USPD = 5497, VCMPTRUE_USPS = 5095, VCMPTRUE_USSD = 6301,
	 VCMPTRUE_USSS = 5899, VCMPUNORDPD = 5140, VCMPUNORDPS = 4738, VCMPUNORDSD = 5944,
	 VCMPUNORDSS = 5542, VCMPUNORD_SPD = 5330, VCMPUNORD_SPS = 4928, VCMPUNORD_SSD = 6134,
	 VCMPUNORD_SSS = 5732, VCOMISD = 2818, VCOMISS = 2809, VCVTDQ2PD = 6841,
	 VCVTDQ2PS = 3360, VCVTPD2DQ = 6852, VCVTPD2PS = 3296, VCVTPS2DQ = 3371,
	 VCVTPS2PD = 3285, VCVTSD2SI = 2744, VCVTSD2SS = 3318, VCVTSI2SD = 2558,
	 VCVTSI2SS = 2547, VCVTSS2SD = 3307, VCVTSS2SI = 2733, VCVTTPD2DQ = 6829,
	 VCVTTPS2DQ = 3382, VCVTTSD2SI = 2681, VCVTTSS2SI = 2669, VDIVPD = 3550,
	 VDIVPS = 3542, VDIVSD = 3566, VDIVSS = 3558, VDPPD = 9643, VDPPS = 9630,
	 VERR = 1679, VERW = 1685, VEXTRACTF128 = 9538, VEXTRACTPS = 9513,
	 VFMADD132PD = 8409, VFMADD132PS = 8396, VFMADD132SD = 8435, VFMADD132SS = 8422,
	 VFMADD213PD = 8689, VFMADD213PS = 8676, VFMADD213SD = 8715, VFMADD213SS = 8702,
	 VFMADD231PD = 8969, VFMADD231PS = 8956, VFMADD231SD = 8995, VFMADD231SS = 8982,
	 VFMADDSUB132PD = 8348, VFMADDSUB132PS = 8332, VFMADDSUB213PD = 8628,
	 VFMADDSUB213PS = 8612, VFMADDSUB231PD = 8908, VFMADDSUB231PS = 8892,
	 VFMSUB132PD = 8461, VFMSUB132PS = 8448, VFMSUB132SD = 8487, VFMSUB132SS = 8474,
	 VFMSUB213PD = 8741, VFMSUB213PS = 8728, VFMSUB213SD = 8767, VFMSUB213SS = 8754,
	 VFMSUB231PD = 9021, VFMSUB231PS = 9008, VFMSUB231SD = 9047, VFMSUB231SS = 9034,
	 VFMSUBADD132PD = 8380, VFMSUBADD132PS = 8364, VFMSUBADD213PD = 8660,
	 VFMSUBADD213PS = 8644, VFMSUBADD231PD = 8940, VFMSUBADD231PS = 8924,
	 VFNMADD132PD = 8514, VFNMADD132PS = 8500, VFNMADD132SD = 8542, VFNMADD132SS = 8528,
	 VFNMADD213PD = 8794, VFNMADD213PS = 8780, VFNMADD213SD = 8822, VFNMADD213SS = 8808,
	 VFNMADD231PD = 9074, VFNMADD231PS = 9060, VFNMADD231SD = 9102, VFNMADD231SS = 9088,
	 VFNMSUB132PD = 8570, VFNMSUB132PS = 8556, VFNMSUB132SD = 8598, VFNMSUB132SS = 8584,
	 VFNMSUB213PD = 8850, VFNMSUB213PS = 8836, VFNMSUB213SD = 8878, VFNMSUB213SS = 8864,
	 VFNMSUB231PD = 9130, VFNMSUB231PS = 9116, VFNMSUB231SD = 9158, VFNMSUB231SS = 9144,
	 VHADDPD = 4219, VHADDPS = 4228, VHSUBPD = 4253, VHSUBPS = 4262, VINSERTF128 = 9525,
	 VINSERTPS = 9579, VLDDQU = 7023, VLDMXCSR = 9963, VMASKMOVDQU = 7153,
	 VMASKMOVPD = 7971, VMASKMOVPS = 7959, VMAXPD = 3610, VMAXPS = 3602,
	 VMAXSD = 3626, VMAXSS = 3618, VMCALL = 1735, VMCLEAR = 10011, VMFUNC = 1803,
	 VMINPD = 3490, VMINPS = 3482, VMINSD = 3506, VMINSS = 3498, VMLAUNCH = 1743,
	 VMLOAD = 1833, VMMCALL = 1824, VMOVAPD = 2498, VMOVAPS = 2489, VMOVD = 3954,
	 VMOVDDUP = 2256, VMOVDQA = 3984, VMOVDQU = 3993, VMOVHLPS = 2217,
	 VMOVHPD = 2404, VMOVHPS = 2395, VMOVLHPS = 2385, VMOVLPD = 2236, VMOVLPS = 2227,
	 VMOVMSKPD = 2858, VMOVMSKPS = 2847, VMOVNTDQ = 6880, VMOVNTDQA = 7927,
	 VMOVNTPD = 2615, VMOVNTPS = 2605, VMOVQ = 3961, VMOVSD = 2165, VMOVSHDUP = 2413,
	 VMOVSLDUP = 2245, VMOVSS = 2157, VMOVUPD = 2148, VMOVUPS = 2139, VMPSADBW = 9659,
	 VMPTRLD = 10002, VMPTRST = 6407, VMREAD = 4150, VMRESUME = 1753, VMRUN = 1817,
	 VMSAVE = 1841, VMULPD = 3221, VMULPS = 3213, VMULSD = 3237, VMULSS = 3229,
	 VMWRITE = 4174, VMXOFF = 1763, VMXON = 10020, VORPD = 3088, VORPS = 3081,
	 VPABSB = 7717, VPABSD = 7747, VPABSW = 7732, VPACKSSDW = 3881, VPACKSSWB = 3713,
	 VPACKUSDW = 7948, VPACKUSWB = 3791, VPADDB = 7233, VPADDD = 7263,
	 VPADDQ = 6510, VPADDSB = 6960, VPADDSW = 6977, VPADDUSW = 6651, VPADDW = 7248,
	 VPALIGNR = 9441, VPAND = 6635, VPANDN = 6694, VPAVGB = 6709, VPAVGW = 6754,
	 VPBLENDVB = 9714, VPBLENDW = 9422, VPCLMULQDQ = 9680, VPCMPEQB = 4074,
	 VPCMPEQD = 4112, VPCMPEQQ = 7907, VPCMPEQW = 4093, VPCMPESTRI = 9759,
	 VPCMPESTRM = 9736, VPCMPGTB = 3733, VPCMPGTD = 3771, VPCMPGTQ = 8118,
	 VPCMPGTW = 3752, VPCMPISTRI = 9805, VPCMPISTRM = 9782, VPERM2F128 = 9287,
	 VPERMILPD = 7592, VPERMILPS = 7581, VPEXTRB = 9459, VPEXTRD = 9484,
	 VPEXTRQ = 9493, VPEXTRW = 6341, VPHADDD = 7405, VPHADDSW = 7423, VPHADDW = 7388,
	 VPHMINPOSUW = 8293, VPHSUBD = 7481, VPHSUBSW = 7499, VPHSUBW = 7464,
	 VPINSRB = 9560, VPINSRD = 9606, VPINSRQ = 9615, VPINSRW = 6324, VPMADDUBSW = 7444,
	 VPMADDWD = 7104, VPMAXSB = 8204, VPMAXSD = 8221, VPMAXSW = 6994, VPMAXUB = 6678,
	 VPMAXUD = 8255, VPMAXUW = 8238, VPMINSB = 8136, VPMINSD = 8153, VPMINSW = 6932,
	 VPMINUB = 6620, VPMINUD = 8187, VPMINUW = 8170, VPMOVMSKB = 6563,
	 VPMOVSXBD = 7786, VPMOVSXBQ = 7807, VPMOVSXBW = 7765, VPMOVSXDQ = 7870,
	 VPMOVSXWD = 7828, VPMOVSXWQ = 7849, VPMOVZXBD = 8014, VPMOVZXBQ = 8035,
	 VPMOVZXBW = 7993, VPMOVZXDQ = 8098, VPMOVZXWD = 8056, VPMOVZXWQ = 8077,
	 VPMULDQ = 7889, VPMULHRSW = 7570, VPMULHUW = 6771, VPMULHW = 6789,
	 VPMULLD = 8272, VPMULLW = 6526, VPMULUDQ = 7085, VPOR = 6946, VPSADBW = 7122,
	 VPSHUFB = 7371, VPSHUFD = 4036, VPSHUFHW = 4045, VPSHUFLW = 4055,
	 VPSIGNB = 7517, VPSIGND = 7551, VPSIGNW = 7534, VPSLLD = 7053, VPSLLDQ = 9877,
	 VPSLLQ = 7068, VPSLLW = 7038, VPSRAD = 6739, VPSRAW = 6724, VPSRLD = 6480,
	 VPSRLDQ = 9860, VPSRLQ = 6495, VPSRLW = 6465, VPSUBB = 7173, VPSUBD = 7203,
	 VPSUBQ = 7218, VPSUBSB = 6898, VPSUBSW = 6915, VPSUBUSB = 6583, VPSUBUSW = 6602,
	 VPSUBW = 7188, VPTEST = 7658, VPUNPCKHBW = 3813, VPUNPCKHDQ = 3859,
	 VPUNPCKHQDQ = 3929, VPUNPCKHWD = 3836, VPUNPCKLBW = 3645, VPUNPCKLDQ = 3691,
	 VPUNPCKLQDQ = 3904, VPUNPCKLWD = 3668, VPXOR = 7009, VRCPPS = 2989,
	 VRCPSS = 2997, VROUNDPD = 9327, VROUNDPS = 9308, VROUNDSD = 9365,
	 VROUNDSS = 9346, VRSQRTPS = 2955, VRSQRTSS = 2965, VSHUFPD = 6375,
	 VSHUFPS = 6366, VSQRTPD = 2910, VSQRTPS = 2901, VSQRTSD = 2928, VSQRTSS = 2919,
	 VSTMXCSR = 9992, VSUBPD = 3430, VSUBPS = 3422, VSUBSD = 3446, VSUBSS = 3438,
	 VTESTPD = 7612, VTESTPS = 7603, VUCOMISD = 2783, VUCOMISS = 2773,
	 VUNPCKHPD = 2339, VUNPCKHPS = 2328, VUNPCKLPD = 2297, VUNPCKLPS = 2286,
	 VXORPD = 3117, VXORPS = 3109, VZEROALL = 4140, VZEROUPPER = 4128,
     WAIT = 10042, 
     WBINVD = 561, 
     WRFSBASE = 9953, 
     WRGSBASE = 9982, 
     WRMSR = 586,
     XABORT = 1007, 
     XADD = 946, 
     XBEGIN = 1015, 
     XCHG = 212, 
     XEND = 1811,
     XGETBV = 1787, 
     XLAT = 400, 
     XOR = 61, 
     XORPD = 3102, 
     XORPS = 3095,
     XRSTOR = 4295, 
     XRSTOR64 = 4303, 
     XSAVE = 4271, 
     XSAVE64 = 4278, 
     XSAVEOPT = 4321,
     XSAVEOPT64 = 4331, 
     XSETBV = 1795, 
     _3DNOW = 10056
 } ;

--[[
    SI - Source Index
    DI - Destination Index
    BP - (stack) Base Pointer
    SP - Stack Pointer
]]
local RegisterType = enum {
    RAX = 0;RCX = 1;RDX = 2;RBX = 3;RSP = 4;RBP = 5;RSI = 6;RDI = 7;R8 = 8;R9 = 9;R10 = 10;R11 = 11;R12 = 12;R13 = 13;R14 = 14;R15 = 15;
EAX = 16;ECX = 17;EDX = 18;EBX = 19;ESP = 20;EBP = 21;ESI = 22;EDI = 23;R8D = 24;R9D = 25;R10D = 26;R11D = 27;R12D = 28;R13D = 29;R14D = 30;R15D = 31;
AX = 32;CX = 33;DX = 34;BX = 35;SP = 36;BP = 37;SI = 38;DI = 39;R8W = 40;R9W = 41;R10W = 42;R11W = 43;R12W = 44;R13W = 45;R14W = 46;R15W = 47;
AL = 48;CL = 49;DL = 50;BL = 51;AH = 52;CH = 53;DH = 54;BH = 55;R8B = 56;R9B = 57;R10B = 58;R11B = 59;R12B = 60;R13B = 61;R14B = 62;R15B = 63;
SPL = 64;BPL = 65;SIL = 66;DIL = 67;
ES = 68;CS = 69;SS = 70;DS = 71;FS = 72;GS = 73;
RIP = 74;
ST0 = 75;ST1 = 76;ST2 = 77;ST3 = 78;ST4 = 79;ST5 = 80;ST6 = 81;ST7 = 82;
MM0 = 83;MM1 = 84;MM2 = 85;MM3 = 86;MM4 = 87;MM5 = 88;MM6 = 89;MM7 = 90;
XMM0 = 91;XMM1 = 92;XMM2 = 93;XMM3 = 94;XMM4 = 95;XMM5 = 96;XMM6 = 97;XMM7 = 98;XMM8 = 99;XMM9 = 100;XMM10 = 101;XMM11 = 102;XMM12 = 103;XMM13 = 104;XMM14 = 105;XMM15 = 106;
YMM0 = 107;YMM1 = 108;YMM2 = 109;YMM3 = 110;YMM4 = 111;YMM5 = 112;YMM6 = 113;YMM7 = 114;YMM8 = 115;YMM9 = 116;YMM10 = 117;YMM11 = 118;YMM12 = 119;YMM13 = 120;YMM14 = 121;YMM15 = 122;
CR0 = 123;UNUSED0 = 124;CR2 = 125;CR3 = 126;CR4 = 127;UNUSED1 = 128;UNUSED2 = 129;UNUSED3 = 130;CR8 = 131;
DR0 = 132;DR1 = 133;DR2 = 134;DR3 = 135;UNUSED4 = 136;UNUSED5 = 137;DR6 = 138;DR7 = 139;
};

return {
    InstructionType = InstructionType;
    RegisterType = RegisterType;
}